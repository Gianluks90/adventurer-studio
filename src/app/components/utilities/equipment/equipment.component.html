<div as-section-title [ngStyle]="{'color': charData.status.sheetTitleColor && !isCampaign ? charData.status.sheetTitleColor : '#212121'}">Equipaggiamento</div>
@if (editModeData) {
    <div class="buttons-container">
        <button as-mini-circle-btn (click)="openManageDialog()">
            <div class="material-symbols-outlined">settings</div>
        </button>
        <button as-mini-circle-btn [disabled]="setsData.length <= 1" (click)="changeSet()">
            <div class="material-symbols-outlined">restart_alt</div>
        </button>
        <!-- <button as-mini-circle-btn disabled>
            <div class="material-symbols-outlined">info</div>
        </button> -->
    </div>
}
<!-- Elenco equipaggiamento come icone -->
<!-- @if (wearedItems.length > 0) {
    <div class="equip-container">
        @for (i of wearedItems; track $index) {
            @if (i) {
                <img class="equip-card" [src]="i.icon" [ngStyle]="{'border-color': setColor(i.rarity)}"
                (mouseover)="showTooltip($event, i)" (mouseleave)="hideTooltip()">
                <app-item-tooltip id="item-tooltip-equip" [item]="i" *ngIf="showItemTooltip && i === currentTooltipItem" class="tooltip" [ngStyle]="{'top.px': tooltipPosition.top, 'left.px': tooltipPosition.left}"></app-item-tooltip>
            }
        }
    </div>
    } @else {
        <div [ngStyle]="{'color': charData.status.sheetTitleColor}" class="no-equip">Nessun oggetto equipaggiato</div>
    } -->
    <div class="equip-container" [ngStyle]="{'grid-template-columns': wearedItems.length <= 0 ? '1fr' : 'repeat(10, 1fr)'}">
        @for (i of wearedItems; track idx; let idx = $index) {
            <!-- @if (i) { -->
                <img class="equip-card" [src]="i.icon" [ngStyle]="{'border-color': setColor(i.rarity)}"
                (mouseover)="showTooltip($event, i)" (mouseleave)="hideTooltip()" (click)="openInfoSheet(i, idx)">
                <app-item-tooltip id="item-tooltip-equip" [item]="i" *ngIf="showItemTooltip && i === currentTooltipItem" class="tooltip" [ngStyle]="{'top.px': tooltipPosition.top, 'left.px': tooltipPosition.left}"></app-item-tooltip>
            <!-- } -->
        } @empty {
            <div [ngStyle]="{'color': charData.status.sheetTitleColor}" class="no-equip">Nessun oggetto equipaggiato</div>
        }
    </div>

<div class="parameter-grid">
    
    <!-- Danni -->
    @if (setsData.length > 0) {
        @if (setsData[setIndex].mainHand && setsData[setIndex].mainHand.name !== '') {
        <div class="grid-item">
            <span class="parameter-label">Danni ({{setsData[setIndex].name}})</span> 
            <div class="speed-container">
                {{ 
                    (setsData[setIndex].versatile ? getDamagesString(setsData[setIndex].mainHand.versatileDice, setsData[setIndex].skill, setsData[setIndex].mainHand.extraDamages) : 
                        (setsData[setIndex].dualWield ? getDamagesString(setsData[setIndex].mainHand.damageFormula + '+' + setsData[setIndex].offHand.damageFormula, setsData[setIndex].skill) :
                            (getDamagesString(setsData[setIndex].mainHand.damageFormula, setsData[setIndex].skill, setsData[setIndex].mainHand.extraDamages) || '1')
                        )
                    )
                }} <span class="parameter-label">
                    ({{
                        (setsData[setIndex].versatile ? getDiceFormula(setsData[setIndex].mainHand.versatileDice, setsData[setIndex].skill, setsData[setIndex].mainHand.extraDamages) : 
                        (setsData[setIndex].dualWield ? getDiceFormula(setsData[setIndex].mainHand.damageFormula + '+' + setsData[setIndex].offHand.damageFormula, setsData[setIndex].skill) :
                        (getDiceFormula(setsData[setIndex].mainHand.damageFormula, setsData[setIndex].skill, setsData[setIndex].mainHand.extraDamages) || '1'))
                    )
                    }})
                </span>         
            </div>
        </div> 
        } @else {
        <div class="grid-item"><span class="parameter-label">Danni ({{setsData[setIndex].name}})</span> 1</div>
        }
    } @else {
        <div class="grid-item"><span class="parameter-label">Danni</span> 1</div>
    }
    <!-- Munizioni -->
    @if (ammo) {
        <div class="grid-item speed-title">
            <span class="parameter-label">Munizioni ({{ammo.name}}<span *ngIf="ammoCounter > 0">, usate: {{ammoCounter}}</span>)</span> 
            <div class="speed-container">
                <button as-mini-circle-light-btn class="very-mini-btn" (click)="ammoAction('add')">
                    <div class="material-symbols-outlined">add</div>
                </button>
                {{ammo.quantity}} 
                <button as-mini-circle-light-btn class="very-mini-btn" (click)="ammoAction('remove')">
                    <div class="material-symbols-outlined">remove</div>
                </button>
            </div>
        </div>
    }
    <!-- Velocità -->
    <div class="grid-item">
        <div class="parameter-label">Velocità</div>
        <div class="speed-container">{{charData.velocita}}m
            <span class="parameter-label">({{charData.velocita/1.5}} spazi)</span>
        </div>
    </div>
    <div class="parameter-grid inner-grid">
        <!-- CA -->
        <div class="grid-item"><span class="parameter-label">CA</span> {{CA}}</div>
        <!-- Iniziativa -->
        <div class="grid-item"><span class="parameter-label">Iniziativa</span>{{initiative}}</div>
    </div>
    <!-- Velocità -->
</div>
<!-- Qui sotto ci andrà l'elenco di tratti, ecc... -->