<div class="home-container" *ngIf="campaignData">
    <div class="header-container">
        <div class="header-info">
            <div class="header-title">
                {{campaignData.title}}
            </div>
            <div class="title-subtitle">
                <!-- <div>Stato: {{campaignData.status.statusMessage}}</div> -->
                <div>Capitolo {{campaignData.archive.length +1}}</div>
                <div>Sessioni {{sessionNumber}}</div>
                @if (campaignData.nextSession) {
                    @if (campaignData.nextSession.toDate() > today){
                        <div>Prossima {{campaignData.nextSession.toDate() | date: 'dd/MM' }}</div>
                    } @else {
                        <div>Prossima prevista per oggi</div>
                    }
                }
            </div>
        </div>
        <div class="header-date">
            @if (isOwner) {
                <button mat-mini-fab color="primary" (click)="openNextSessionDialog()">
                    <mat-icon>calendar_month</mat-icon>
                </button>
            }
        </div>
    </div>
    <div class="view-tabs">
        <div class="status-container">
            <app-campaign-char-list [characters]="charData" [isOwner]="isOwner"></app-campaign-char-list>
        </div>
        <mat-tab-group color="accent">
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/story.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Storia">
                </ng-template>
                <app-campaign-story-tab [description]="campaignData.description" [campaign]="campaignData"
                    [sessionNumber]="sessionNumber" [isOwner]="isOwner"></app-campaign-story-tab>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/quests.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Missioni">
                </ng-template>
                <app-campaign-quests-tab [campaign]="campaignData" [isOwner]="isOwner"></app-campaign-quests-tab>
            </mat-tab>
            <mat-tab *ngIf="charData.length > 0 && !isOwner" >
                <ng-template mat-tab-label>
                    <img class="player-tab" [src]="selectedChar.informazioniBase.urlImmaginePersonaggio" matTooltipPosition="below" [matTooltip]="selectedChar.informazioniBase.nomePersonaggioEsteso !== '' ? selectedChar.informazioniBase.nomePersonaggioEsteso : selectedChar.informazioniBase.nomePersonaggio">
                </ng-template>
                <app-campaign-char-tab [character]="selectedChar"></app-campaign-char-tab>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/tabs-icons/ally.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="PNG, Organizzazioni e Schede">
                </ng-template>
                <app-campaign-npc-tab [campaign]="campaignData" [isOwner]="isOwner"></app-campaign-npc-tab>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/tabs-icons/inventory.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Inventario">
                </ng-template>
                <app-campaign-inventory-tab [campaign]="campaignData" [isOwner]="isOwner"
                    [characters]="charData"></app-campaign-inventory-tab>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/rules.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Annotazioni">
                </ng-template>
                <app-campaign-entries-tab [entries]="campaignData.entries"
                    [isOwner]="isOwner"></app-campaign-entries-tab>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/trophy.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Trofei">
                </ng-template>
                <app-campaign-achievements-tab [campaign]="campaignData" [isOwner]="isOwner"
                    [characters]="charData"></app-campaign-achievements-tab>
            </mat-tab>
            <mat-tab disabled>
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/encounter.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Incontro">
                </ng-template>
            </mat-tab>
            <mat-tab *ngIf="isOwner">
                <ng-template mat-tab-label>
                    <img src="./assets/campaign-tabs-icon/dmScreen.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Schermo del master">
                </ng-template>
                <app-master-screen-tab [campaign]="campaignData" [isOwner]="isOwner"></app-master-screen-tab>
            </mat-tab>
            <mat-tab *ngIf="isOwner">
                <ng-template mat-tab-label>
                    <img src="./assets/tabs-icons/cog.svg" class="label-icon" matTooltipPosition="below"
                        matTooltip="Impostazioni">
                </ng-template>
                <app-campaign-settings-tab [campaign]="campaignData" [characters]="charData"
                    [isOwner]="isOwner"></app-campaign-settings-tab>
            </mat-tab>
        </mat-tab-group>
    </div>
</div>

<div class="sidenav-buttons" id="menu-button">
    <button class="step-button" mat-icon-button (click)="openSidenav()" matTooltip="Menu" matTooltipPosition="right">
        <mat-icon>menu</mat-icon>
    </button>
</div>

<!-- <div class="dice-buttons" id="dice-button" *ngIf="campaignData && campaignData.dddiceSlug !== undefined">
    <button class="step-button" mat-icon-button (click)="openDiceSelector()" matTooltip="Dadi"
        matTooltipPosition="right" [disabled]="campaignData.dddiceSlug === ''">
        <img src="./assets/dice/dice-d20-white.svg" alt="">
    </button>
</div> -->

<!-- <div class="dice-buttons" id="dice-button" *ngIf="campaignData && campaignData.dddiceSlug !== undefined">
    <button class="step-button" mat-icon-button (click)="openDiceSelector()" matTooltip="Dadi"
        matTooltipPosition="right" disabled>
        <img src="./assets/dice/dice-d20-white.svg" alt="">
    </button>
</div> -->